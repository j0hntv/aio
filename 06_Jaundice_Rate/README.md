# Фильтр желтушных новостей

Сервис для определения желтушности новостей. Для работы передать GET-параметру `urls` адреса новостных статей, перечисленные через запятую.

Пока поддерживается только один новостной сайт - [ИНОСМИ.РУ](https://inosmi.ru/). Для него разработан специальный адаптер, умеющий выделять текст статьи на фоне остальной HTML разметки. Для других новостных сайтов потребуются новые адаптеры, все они будут находиться в каталоге `adapters`. Туда же помещен код для сайта ИНОСМИ.РУ: `adapters/inosmi_ru.py`.

В перспективе можно создать универсальный адаптер, подходящий для всех сайтов, но его разработка будет сложной и потребует дополнительных времени и сил.

# Как установить

Вам понадобится Python версии 3.7 или старше. Для установки пакетов рекомендуется создать виртуальное окружение.

Первым шагом установите пакеты:

```
pip install -r requirements.txt
```
# Как настроить
С помощью переменных окружения:

`MAX_URLS_IN_REQUEST` - максимальное количество url, которое можно передать GET-параметру, по умолчанию - 10

`MAX_TIMEOUT` - Сколько ждать ответа, по умолчанию - 3 (секунды)

`DEBUG` - Показывать в консоли время, затраченное на анализ статьи, по умолчанию - False

# Как запустить

```
cd app/
python server.py
```
# Как запустить с помощью Docker
```
docker build -t jaundice_rate .
```
```
docker run -d -p 8080:8080 jaundice_rate
```
# Как пользоваться:
Открыть в браузере:
```
http://0.0.0.0:8080/?urls=https://python.org,http://some-example.com,https://inosmi.ru/science/20210609/249881819.html
```
Результат:
```
{
    "result": [
        {
            "status": "FETCH ERROR",
            "url": "http://some-example.com",
            "title": "URL not exist",
            "score": null,
            "words_count": null
        },
        {
            "status": "OK",
            "url": "https://inosmi.ru/science/20210609/249881819.html",
            "title": "Science (США): как возникло и как исчезло крупнейшее в мире озеро",
            "score": 1.97,
            "words_count": 558
        },
        {
            "status": "PARSING ERROR",
            "url": "https://python.org",
            "title": "Welcome to Python.org",
            "score": null,
            "words_count": null
        }
    ]
}
```

# Как запустить тесты

Для тестирования используется [pytest](https://docs.pytest.org/en/latest/), тестами покрыты фрагменты кода сложные в отладке: text_tools.py и адаптеры. Команды для запуска тестов:

```
cd app/
python -m pytest adapters/inosmi_ru.py
python -m pytest text_tools.py
python -m pytest article_tools.py
```

# Цели проекта

Код написан в учебных целях. Это урок из курса по веб-разработке — [Девман](https://dvmn.org).
